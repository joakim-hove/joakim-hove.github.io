

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>The data types available in ERT &#8212; ERT 2.3 documentation</title>
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Running simulations - the Forward Model" href="../forward_model/index.html" />
    <link rel="prev" title="Introduction to ERT and Ensemble based methods" href="../introduction/index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../forward_model/index.html" title="Running simulations - the Forward Model"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../introduction/index.html" title="Introduction to ERT and Ensemble based methods"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../manual.html">ERT 2.3 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../manual.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The data types available in ERT</a><ul>
<li><a class="reference internal" href="#parameters">Parameters</a><ul>
<li><a class="reference internal" href="#scalar-parameters-with-a-template-gen-kw">Scalar parameters with a template: GEN_KW</a><ul>
<li><a class="reference internal" href="#example-configuring-gen-kw-to-estimate-multpv-values">Example: configuring GEN_KW to estimate MULTPV values</a></li>
<li><a class="reference internal" href="#the-prior-it-is-really-a-transformation">The prior - it is really a <em>transformation</em></a><ul>
<li><a class="reference internal" href="#normal">NORMAL</a></li>
<li><a class="reference internal" href="#lognormal">LOGNORMAL</a></li>
<li><a class="reference internal" href="#truncated-normal">TRUNCATED_NORMAL</a></li>
<li><a class="reference internal" href="#uniform">UNIFORM</a></li>
<li><a class="reference internal" href="#logunif">LOGUNIF</a></li>
<li><a class="reference internal" href="#const">CONST</a></li>
<li><a class="reference internal" href="#dunif">DUNIF</a></li>
<li><a class="reference internal" href="#errf">ERRF</a></li>
<li><a class="reference internal" href="#derrf">DERRF</a></li>
</ul>
</li>
<li><a class="reference internal" href="#loading-gen-kw-values-from-an-external-file">Loading GEN_KW values from an external file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-field-parameters-field">3D field parameters: FIELD</a><ul>
<li><a class="reference internal" href="#field-initialization">Field initialization</a><ul>
<li><a class="reference internal" href="#initialization-with-init-files">Initialization with INIT_FILES</a></li>
<li><a class="reference internal" href="#initialization-with-forward-init">Initialization with FORWARD_INIT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#field-transformations">Field transformations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-surface-parameters-surface">2D Surface parameters: SURFACE</a></li>
<li><a class="reference internal" href="#general-vector-parameters-gen-param">General vector parameters: GEN_PARAM</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simulated-data">Simulated data</a><ul>
<li><a class="reference internal" href="#summary-summary">Summary: SUMMARY</a></li>
<li><a class="reference internal" href="#general-data-gen-data">General data: GEN_DATA</a></li>
<li><a class="reference internal" href="#keyword-results-custom-kw">Keyword results: CUSTOM_KW</a></li>
</ul>
</li>
<li><a class="reference internal" href="#enkf-heritage">EnKF heritage</a></li>
<li><a class="reference internal" href="#observations">Observations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../introduction/index.html"
                        title="previous chapter">Introduction to ERT and Ensemble based methods</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../forward_model/index.html"
                        title="next chapter">Running simulations - the Forward Model</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/data_types/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-data-types-available-in-ert">
<h1>The data types available in ERT<a class="headerlink" href="#the-data-types-available-in-ert" title="Permalink to this headline">¶</a></h1>
<p>Very briefly described the purpose of ERT is to pass uncertain paramater values
to a simulator <a class="footnote-reference" href="#id2" id="id1">[1]</a>, in a form which works as suitable input to the simulator and
then subsequently load the results from the simulator. This means that data must
be formatted in a form which the simulator can load, and also that ERT must be
able to read files generated by the simulator.</p>
<p>The data managed by ERT are organized in different <em>data types</em> described in
this chapter. Configuring the data used in the conditioning project is a very
important part of setting up a ERT configuration file - in practical terms this
is how you configure which uncertainty parameters should be studied. The data
types in ert can be categorized in two ways:</p>
<ol class="arabic simple">
<li>How the data type behaves dynamically: is it a static parameter like porosity
or permeability - i.e. does it serve as <em>input</em> to the simulator, or
is it a quantity which is generated as a result from the simulation. When
understanding the model updating algorithm and process it is important to
understand this difference properly.</li>
<li>How the data type is implemented, what type of files does it read and write,
how is it configured and so on.</li>
</ol>
<p>NB: All datatypes have a common namespace; i.e. a globally unique keyword.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><em>Simulator</em> should in this context be understood as the complete
forward model, including various pre and post processing steps in
addition to the actual reservoir simulation.</td></tr>
</tbody>
</table>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>The <em>parameter</em> datatypes will serve as input to the simulator. For a pure
uncertainty study they will pass right through, model updating update
parameters. Sample internally or load externally.</p>
<div class="section" id="scalar-parameters-with-a-template-gen-kw">
<h3>Scalar parameters with a template: GEN_KW<a class="headerlink" href="#scalar-parameters-with-a-template-gen-kw" title="Permalink to this headline">¶</a></h3>
<p>The GEN_KW datatype is used in situations where you have a handful of related
<a class="footnote-reference" href="#id4" id="id3">[2]</a> parameters. The intention behind the GEN_KW implementation is that ERT will
<em>sample</em> parameters randomly according to a distribution specified by the user,
then ERT will use the sampled values and a template file provided by the user to
generate a file which can be used by the simulator.</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>ERT itself can not impose correlations among the parameters, if you need
that you must implement it yourself in the forward model.</td></tr>
</tbody>
</table>
<p>In the main config file a GEN_KW instance is defined as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEN_KW</span>  <span class="n">ID</span>  <span class="n">templates</span><span class="o">/</span><span class="n">template</span><span class="o">.</span><span class="n">txt</span>  <span class="n">include</span><span class="o">.</span><span class="n">txt</span>  <span class="n">priors</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Here ID is an (arbitrary) unique string, <code class="code docutils literal notranslate"><span class="pre">templates/template.txt</span></code> is the
name of a template file, <code class="code docutils literal notranslate"><span class="pre">include.txt</span></code> is the name of the file which is
made for each realization based on the template file
<code class="code docutils literal notranslate"><span class="pre">templates/template.txt</span></code> and the prior distribution <code class="code docutils literal notranslate"><span class="pre">priors.txt</span></code> is
a file containing a list of parametrized keywords and a prior distribution for
each. Note that you must manually edit the input files of the simulator to
ensure that the generated file <code class="code docutils literal notranslate"><span class="pre">include.txt</span></code> is included.</p>
<div class="section" id="example-configuring-gen-kw-to-estimate-multpv-values">
<h4>Example: configuring GEN_KW to estimate MULTPV values<a class="headerlink" href="#example-configuring-gen-kw-to-estimate-multpv-values" title="Permalink to this headline">¶</a></h4>
<p>Let us consider an example where the GEN_KW parameter type is used to estimate
pore volume multipliers in an Eclipse model. We could then declare a GEN_KW
instance in the main enkf configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEN_KW</span> <span class="n">PAR_MULTPV</span> <span class="n">multpv_template</span><span class="o">.</span><span class="n">txt</span> <span class="n">multpv</span><span class="o">.</span><span class="n">txt</span> <span class="n">multpv_priors</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>In the GRID or EDIT section of the ECLIPSE data file, we would insert the
ollowing include statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INCLUDE</span>
  <span class="s1">&#39;multpv.txt&#39;</span> <span class="o">/</span>
</pre></div>
</div>
<p>The template file multpv_template.txt would contain some parametrized ECLIPSE
statements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BOX</span>
       <span class="mi">1</span> <span class="mi">10</span> <span class="mi">1</span> <span class="mi">30</span> <span class="mi">13</span> <span class="mi">13</span> <span class="o">/</span>

<span class="n">MULTPV</span>
 <span class="mi">300</span><span class="o">*&lt;</span><span class="n">MULTPV_BOX1</span><span class="o">&gt;</span> <span class="o">/</span>

<span class="n">ENDBOX</span>

<span class="n">BOX</span>
       <span class="mi">1</span> <span class="mi">10</span> <span class="mi">1</span> <span class="mi">30</span> <span class="mi">14</span> <span class="mi">14</span> <span class="o">/</span>

<span class="n">MULTPV</span>
       <span class="mi">300</span><span class="o">*&lt;</span><span class="n">MULTPV_BOX2</span><span class="o">&gt;</span> <span class="o">/</span>

<span class="n">ENDBOX</span>
</pre></div>
</div>
<p>Here, &lt;MULTPV_BOX1&gt; and &lt;MULTPV_BOX2&gt; will act as magic strings. Note that the
‘&lt;’ ‘&gt;’ must be present around the magic strings. In this case, the parameter
configuration file multpv_priors.txt could look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MULTPV_BOX2</span> <span class="n">UNIFORM</span> <span class="mf">0.98</span> <span class="mf">1.03</span>
<span class="n">MULTPV_BOX1</span> <span class="n">UNIFORM</span> <span class="mf">0.85</span> <span class="mf">1.00</span>
</pre></div>
</div>
<p>In general, the first keyword on each line in the parameter configuration file
defines a key, which when found in the template file enclosed in ‘&lt;’ and ‘&gt;’, is
replaced with a value. The rest of the line defines a prior distribution for the
key. See Prior distributions available in enkf for a list of available prior
distributions. The various prior distributions available for the <code class="docutils literal notranslate"><span class="pre">GEN_KW</span></code>
keyword are here <span class="xref std std-ref">prior distributions available in ERT</span></p>
</div>
<div class="section" id="the-prior-it-is-really-a-transformation">
<h4>The prior - it is really a <em>transformation</em><a class="headerlink" href="#the-prior-it-is-really-a-transformation" title="Permalink to this headline">¶</a></h4>
<p>The Ensemble Smoother method, which ERT uses for updating of parameters, works
with normally distributed variables. So internally in ERT the interplay between
<code class="docutils literal notranslate"><span class="pre">GEN_KW</span></code> variables and updates is as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>ERT samples a random variable <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">~</span> <span class="pre">N(0,1)</span></code> - before outputing to the
forward model this is <em>transformed</em> to <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">~</span> <span class="pre">F(Y)</span></code> where the the
distribution <code class="docutils literal notranslate"><span class="pre">F(Y)</span></code> is the correct prior distribution.</li>
<li>When the prior simulations are complete ERT calculates misfits between
simulated and observed values and <em>updates</em> the parameters; hence the
variables <code class="docutils literal notranslate"><span class="pre">x</span></code> now represent samples from a posterior distribution which
is Normal with mean and standard deviation <em>different from (0,1)</em>.</li>
</ol>
</div></blockquote>
<p>The transformation prescribed by <code class="docutils literal notranslate"><span class="pre">F(y)</span></code> still “works” - but it no longer maps
to a distribution in the same family as initially specified by the prior. A
consequence of this is that the update process can <em>not</em> give you a posterior
with updated parameters in the same distribution family as the Prior.</p>
<div class="section" id="normal">
<h5>NORMAL<a class="headerlink" href="#normal" title="Permalink to this headline">¶</a></h5>
<p>To set a normal (Gaussian) prior, use the keyword NORMAL. It takes two
arguments, a mean value and a standard deviation. Thus, the following example
will assign a normal prior with mean 0 and standard deviation 1 to the variable
VAR1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VAR1</span>   <span class="n">NORMAL</span>    <span class="mi">0</span>   <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="lognormal">
<h5>LOGNORMAL<a class="headerlink" href="#lognormal" title="Permalink to this headline">¶</a></h5>
<p>A stochastic variable is log normally distributed if the logarithm of the
variable is normally distributed. In other words, if X is normally distributed,
then Y = exp(X) is log normally distributed.</p>
<p>A log normal prior is suited to model positive quanties with a heavy tail
(tendency to take large values). To set a log normal prior, use the keyword
LOGNORMAL. It takes two arguments, the mean and standard deviation of the
<em>logarithm</em> of the variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VAR2</span>   <span class="n">LOGNORMAL</span>  <span class="mi">0</span>  <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="truncated-normal">
<h5>TRUNCATED_NORMAL<a class="headerlink" href="#truncated-normal" title="Permalink to this headline">¶</a></h5>
<p>This <em>TRUNCATED_NORMAL</em> distribution works as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Draw random variable <span class="math notranslate">\(X \sim N(\mu,\sigma)\)</span></li>
<li>Clamp X to the interval [min, max]</li>
</ol>
</div></blockquote>
<p>This is <strong>not</strong> a proper truncated normal distribution; hence the
clamping to <a href="#id5"><span class="problematic" id="id6">``</span></a>[min,max]` should be an exceptional event. To configure
this distribution for a situation with mean 1, standard deviation 0.25
and hard limits 0 and 10:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VAR3</span>  <span class="n">TRUNCATED_NORMAL</span>  <span class="mi">1</span>  <span class="mf">0.25</span>   <span class="mi">0</span>  <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="section" id="uniform">
<h5>UNIFORM<a class="headerlink" href="#uniform" title="Permalink to this headline">¶</a></h5>
<p>A stochastic variable is uniformly distributed if has a constant
probability density on a closed interval. Thus, the uniform
distribution is completely characterized by it’s minimum and maximum
value. To assign a uniform distribution to a variable, use the keyword
UNIFORM, which takes a minimum and a maximum value for a the
variable. Here is an example, which assigns a uniform distribution
between 0 and 1 to a variable <code class="docutils literal notranslate"><span class="pre">VAR4</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VAR4</span> <span class="n">UNIFORM</span> <span class="mi">0</span> <span class="mi">1</span>
</pre></div>
</div>
<p>It can be shown that among all distributions bounded below by a and
above by b, the uniform distribution with parameters a and b has the
maximal entropy (contains the least information). Thus, the uniform
distribution should be your preferred prior distribution for robust
modeling of bounded variables.</p>
</div>
<div class="section" id="logunif">
<h5>LOGUNIF<a class="headerlink" href="#logunif" title="Permalink to this headline">¶</a></h5>
<p>A stochastic variable is log uniformly distributed if it’s logarithm
is uniformly distributed on the interval [a,b]. To assign a log
uniform distribution to a a variable, use the keyword LOGUNIF, which
takes a minimum and a maximum value for the output variable as
arguments. The example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VAR5</span>  <span class="n">LOGUNIF</span> <span class="mf">0.00001</span> <span class="mi">1</span>
</pre></div>
</div>
<p>will give values in the range [0.00001,1] - with considerably more
weight towards the lower limit. The log uniform distribution is useful
when modeling a bounded positive variable who has most of it’s
probability weight towards one of the bounds.</p>
</div>
<div class="section" id="const">
<h5>CONST<a class="headerlink" href="#const" title="Permalink to this headline">¶</a></h5>
<p>The keyword CONST is used to assign a Dirac distribution to a variable, i.e. set
it to a constant value. Here is an example of use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VAR6</span> <span class="n">CONST</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<div class="section" id="dunif">
<h5>DUNIF<a class="headerlink" href="#dunif" title="Permalink to this headline">¶</a></h5>
<p>The keyword DUNIF is used to assign a discrete uniform distribution. It takes
three arguments, the number bins, a minimum and maximum value. Here is an
example which creates a discrete uniform distribution on [0,1] with 25 bins:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VAR7</span> <span class="n">DUNIF</span> <span class="mi">25</span> <span class="mi">0</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="errf">
<h5>ERRF<a class="headerlink" href="#errf" title="Permalink to this headline">¶</a></h5>
<p>The ERRF keyword is used to define a prior resulting from applying the error
function to a normally distributed variable with mean 0 and variance 1. The
keyword takes four arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VAR8</span> <span class="n">ERRF</span> <span class="n">MIN</span> <span class="n">MAX</span> <span class="n">SKEWNESS</span> <span class="n">WIDTH</span>
</pre></div>
</div>
<p>The arguments MIN and MAX sets the minimum and maximum value of the transform.
Zero SKEWNESS results in a symmetric distribution, whereas negative SKEWNESS
will shift the distribution towards the left and positive SKEWNESS will shift it
towards the right. Letting WIDTH be larger than one will cause the distribution
to be unimodal, whereas WIDTH less than one will create a bi-modal distribution.</p>
</div>
<div class="section" id="derrf">
<h5>DERRF<a class="headerlink" href="#derrf" title="Permalink to this headline">¶</a></h5>
<p>The keyword DERRF is similar to ERRF, but will create a discrete output. DERRF
takes 5 arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VAR9</span> <span class="n">DERRF</span> <span class="n">NBINS</span> <span class="n">MIN</span> <span class="n">MAX</span> <span class="n">SKEWNESS</span> <span class="n">WIDTH</span>
</pre></div>
</div>
<p>NBINS set the number of discrete values, and the other arguments have the same
effect as in ERRF.</p>
</div>
</div>
<div class="section" id="loading-gen-kw-values-from-an-external-file">
<h4>Loading GEN_KW values from an external file<a class="headerlink" href="#loading-gen-kw-values-from-an-external-file" title="Permalink to this headline">¶</a></h4>
<p>The default use of the GEN_KW keyword is to let the ERT application sample
random values for the elements in the GEN_KW instance, but it is also possible
to tell ERT to load a precreated set of data files, this can for instance be
used as a component in a experimental design based workflow. When using external
files to initialize the GEN_KW instances you supply an extra keyword
<code class="docutils literal notranslate"><span class="pre">INIT_FILE:/path/to/priors/files%d</span></code> which tells where the prior files are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEN_KW</span>  <span class="n">MY</span><span class="o">-</span><span class="n">FAULTS</span>   <span class="n">MULTFLT</span><span class="o">.</span><span class="n">tmpl</span>   <span class="n">MULTFLT</span><span class="o">.</span><span class="n">INC</span>   <span class="n">MULTFLT</span><span class="o">.</span><span class="n">txt</span>    <span class="n">INIT_FILES</span><span class="p">:</span><span class="n">priors</span><span class="o">/</span><span class="n">multflt</span><span class="o">/</span><span class="n">faults</span><span class="o">%</span><span class="n">d</span>
</pre></div>
</div>
<p>In the example above you must prepare files priors/multflt/faults0,
priors/multflt/faults1, … priors/multflt/faultsn which ert will load when you
initialize the case. The format of the GEN_KW input files can be of two
varieties:</p>
<ol class="arabic simple">
<li>The files can be plain ASCII text files with a list of numbers:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.25</span>
<span class="mf">2.67</span>
</pre></div>
</div>
<p>The numbers will be assigned to parameters in the order found in the MULTFLT.txt file.</p>
<ol class="arabic simple" start="2">
<li>Alternatively values and keywords can be interleaved as in:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FAULT1</span> <span class="mf">1.25</span>
<span class="n">FAULT2</span> <span class="mf">2.56</span>
</pre></div>
</div>
<p>in this case the ordering can differ in the init files and the parameter file.</p>
<p>The heritage of the ERT program is based on the EnKF algorithm, and the EnKF
algorithm evolves around Gaussian variables - internally the GEN_KW variables
are assumed to be samples from the N(0,1) distribution, and the distributions
specified in the parameters file are based on transformations starting with a
N(0,1) distributed variable. The slightly awkward consequence of this is that to
let your sampled values pass through ERT unmodified you must configure the
distribution NORMAL 0 1 in the parameter file; alternatively if you do not
intend to update the GEN_KW variable you can use the distribution RAW.</p>
</div>
</div>
<div class="section" id="d-field-parameters-field">
<h3>3D field parameters: FIELD<a class="headerlink" href="#d-field-parameters-field" title="Permalink to this headline">¶</a></h3>
<p>The FIELD data type is used to parametrize quantities which have extent over the
full grid; porosity and permeability are the most typical examples of quantities
which are estimated and modelled with the FIELD data type. In the configuration
file the FIELD keywords are configured like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FIELD</span>  <span class="n">PORO</span> <span class="n">PARAMETER</span>  <span class="n">poro</span><span class="o">.</span><span class="n">grdecl</span>  <span class="n">INIT_FILES</span><span class="p">:</span><span class="o">/</span><span class="n">path</span><span class="o">/%</span><span class="n">d</span>  <span class="n">MIN</span><span class="p">:</span><span class="n">X</span> <span class="n">MAX</span><span class="p">:</span><span class="n">Y</span> <span class="n">OUTPUT_TRANSFORM</span><span class="p">:</span><span class="n">FUNC</span> <span class="n">INIT_TRANSFORM</span><span class="p">:</span><span class="n">FUNC</span>
</pre></div>
</div>
<p>PORO is in principle an arbitrary string ID, but if the fields in question
represent e.g. the porosity use of a matching string of course makes sense. The
string “PARAMETER” serves no purpose at the moment, but is legacy from the
time when ERT could do full EnKF and also needed to handle dynamic fields like
pressure and saturations.</p>
<p>The “poro.grdecl” argument represents the name of the file which ert will
prepare for the forward model, observe the reservoir data file must have an
<cite>INCLUDE</cite> statement corresponding to this file, i.e.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INCLUDE</span>
    <span class="s1">&#39;poro.grdecl&#39;</span> <span class="o">/</span>
</pre></div>
</div>
<p>For the example above.</p>
<div class="section" id="field-initialization">
<h4>Field initialization<a class="headerlink" href="#field-initialization" title="Permalink to this headline">¶</a></h4>
<p>Observe that ERT can <em>not</em> sample field variables internally, they must be
generated using another application - typically geo modelling software like RMS;
so to use the FIELD datatype you must have a workflow external to ERT which can
create/sample the fields. There are <em>two</em> ways to initialize the fields: use
<cite>INIT_FILES</cite> to load pregenerated initial fields or <cite>FORWARD_INIT</cite> to load as
part of the forward model.</p>
<div class="section" id="initialization-with-init-files">
<h5>Initialization with INIT_FILES<a class="headerlink" href="#initialization-with-init-files" title="Permalink to this headline">¶</a></h5>
<p>, either
you can generate the field realizations up front and then use the <cite>INIT_FILES:</cite>
when configuring the field. Then the <cite>INIT_FILES</cite> attribute should be a filename
<em>with</em> an embedded “%d” which can be used to load the initial files.</p>
<p>arbitrary string, ECLIPSE_FILE is the name of the file the
enkf will export this field to when running simulations. Note that there should
be an IMPORT statement in the ECLIPSE data file corresponding to the name given
with ECLIPSE_FILE. INIT_FILES is a filename (with an embedded %d) to load the
initial field from. Can be RMS ROFF format, ECLIPSE restart format or ECLIPSE
GRDECL format.</p>
</div>
<div class="section" id="initialization-with-forward-init">
<h5>Initialization with FORWARD_INIT<a class="headerlink" href="#initialization-with-forward-init" title="Permalink to this headline">¶</a></h5>
</div>
</div>
<div class="section" id="field-transformations">
<h4>Field transformations<a class="headerlink" href="#field-transformations" title="Permalink to this headline">¶</a></h4>
<p>The input arguments MIN, MAX, INIT_TRANSFORM and OUTPUT_TRANSFORM are all
optional. MIN and MAX are as for dynamic fields.</p>
<p>For Assisted history matching, the variables in ERT should be normally
distributed internally - the purpose of the transformations is to enable working
with normally distributed variables internally in ERT. Thus, the optional
arguments INIT_TRANSFORM:FUNC and OUTPUT_TRANSFORM:FUNC are used to transform
the user input of parameter distribution. INIT_TRANSFORM:FUNC is a function
which will be applied when they are loaded to ERT. OUTPUT_TRANSFORM:FUNC is a
function which will be applied to the field when it is exported from ERT, and
FUNC is the name of a transformation function to be applied. The avaialble
functions are listed below:</p>
<blockquote>
<div>“POW10”       : This function will raise x to the power of 10: y = 10^x.
“TRUNC_POW10” : This function will raise x to the power of 10 - and truncate lower values at 0.001.
“LOG”         : This function will take the NATURAL logarithm of x: y = ln(x).
“LN”          : This function will take the NATURAL logarithm of x: y = ln(x).
“LOG10”       : This function will take the log10 logarithm of x: y = log10(x).
“EXP”         : This function will calculate y = exp(x).
“LN0”         : This function will calculate y = ln(x + 0.000001
“EXP0”        : This function will calculate y = exp(x) - 0.000001</div></blockquote>
<p>For example, the most common scenario is that underlying log-normal distributed
permeability in RMS are transformed to normally distributted in ERT, then you
do:</p>
<p>INIT_TRANSFORM:LOG To ensure that the variables which were initially log-normal
distributed are transformed to normal distribution when they are loaded into
ert.</p>
<p>OUTPUT_TRANSFORM:EXP To ensure that the variables are reexponentiated to be
log-normal distributed before going out to Eclipse.</p>
<p>If users specify the wrong function name (e.g INIT_TRANSFORM:I_DONT_KNOW), ERT
will stop and print all the valid function names.</p>
<p>Regarding format of ECLIPSE_FILE: The default format for the parameter fields is
binary format of the same type as used in the ECLIPSE restart files. This
requires that the ECLIPSE datafile contains an IMPORT statement. The advantage
with using a binary format is that the files are smaller, and reading/writing is
faster than for plain text files. If you give the ECLIPSE_FILE with the
extension .grdecl (arbitrary case), enkf will produce ordinary .grdecl files,
which are loaded with an INCLUDE statement. This is probably what most users are
used to beforehand - but we recomend the IMPORT form.</p>
</div>
</div>
<div class="section" id="d-surface-parameters-surface">
<h3>2D Surface parameters: SURFACE<a class="headerlink" href="#d-surface-parameters-surface" title="Permalink to this headline">¶</a></h3>
<p>The SURFACE keyword can be used to work with surface from RMS in the irap
format. The surface keyword is configured like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SURFACE</span> <span class="n">TOP</span>   <span class="n">OUTPUT_FILE</span><span class="p">:</span><span class="n">surf</span><span class="o">.</span><span class="n">irap</span>   <span class="n">INIT_FILES</span><span class="p">:</span><span class="n">Surfaces</span><span class="o">/</span><span class="n">surf</span><span class="o">%</span><span class="n">d</span><span class="o">.</span><span class="n">irap</span>   <span class="n">BASE_SURFACE</span><span class="p">:</span><span class="n">Surfaces</span><span class="o">/</span><span class="n">surf0</span><span class="o">.</span><span class="n">irap</span>
</pre></div>
</div>
<p>The first argument, TOP in the example above, is the identifier you want to use
for this surface in ert. The OUTPUT_FILE key is the name of surface file which
ERT will generate for you, INIT_FILES points to a list of files which are used
to initialize, and BASE_SURFACE must point to one existing surface file. When
loading the surfaces ERT will check that all the headers are compatible. An
example of a surface IRAP file is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mi">996</span>   <span class="mi">511</span>     <span class="mf">50.000000</span>     <span class="mf">50.000000</span>
<span class="mf">444229.9688</span>   <span class="mf">457179.9688</span>  <span class="mf">6809537.0000</span>  <span class="mf">6835037.0000</span>
<span class="mi">260</span>      <span class="o">-</span><span class="mf">30.0000</span>   <span class="mf">444229.9688</span>  <span class="mf">6809537.0000</span>
<span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<span class="mf">2735.7461</span>    <span class="mf">2734.8909</span>    <span class="mf">2736.9705</span>    <span class="mf">2737.4048</span>    <span class="mf">2736.2539</span>    <span class="mf">2737.0122</span>
<span class="mf">2740.2644</span>    <span class="mf">2738.4014</span>    <span class="mf">2735.3770</span>    <span class="mf">2735.7327</span>    <span class="mf">2733.4944</span>    <span class="mf">2731.6448</span>
<span class="mf">2731.5454</span>    <span class="mf">2731.4810</span>    <span class="mf">2730.4644</span>    <span class="mf">2730.5591</span>    <span class="mf">2729.8997</span>    <span class="mf">2726.2217</span>
<span class="mf">2721.0996</span>    <span class="mf">2716.5913</span>    <span class="mf">2711.4338</span>    <span class="mf">2707.7791</span>    <span class="mf">2705.4504</span>    <span class="mf">2701.9187</span>
<span class="o">....</span>
</pre></div>
</div>
<p>The surface data will typically be fed into other programs like Cohiba or RMS.
The data can be updated using e.g. the Smoother.</p>
<p><strong>Initializing from the FORWARD MODEL</strong></p>
<p>All the parameter types like FIELD,GEN_KW,GEN_PARAM and SURFACE can be
initialized from the forward model. To achieve this you just add the setting
FORWARD_INIT:True to the configuration. When using forward init the
initialization will work like this:</p>
<ol class="arabic simple">
<li>The explicit initialization from the case menu, or when you start a
simulation, will be ignored.</li>
<li>When the FORWARD_MODEL is complete ERT will try to initialize the node based
on files created by the forward model. If the init fails the job as a whole
will fail.</li>
<li>If a node has been initialized, it will not be initialized again if you run
again. [Should be possible to force this ….]</li>
</ol>
<p>When using FORWARD_INIT:True ERT will consider the INIT_FILES setting to find
which file to initialize from. If the INIT_FILES setting contains a relative
filename, it will be interpreted relativt to the runpath directory. In the
example below we assume that RMS has created a file petro.grdecl which contains
both the PERMX and the PORO fields in grdecl format; we wish to initialize PERMX
and PORO nodes from these files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FIELD</span>   <span class="n">PORO</span>  <span class="n">PARAMETER</span>    <span class="n">poro</span><span class="o">.</span><span class="n">grdecl</span>     <span class="n">INIT_FILES</span><span class="p">:</span><span class="n">petro</span><span class="o">.</span><span class="n">grdecl</span>  <span class="n">FORWARD_INIT</span><span class="p">:</span><span class="kc">True</span>
<span class="n">FIELD</span>   <span class="n">PERMX</span> <span class="n">PARAMETER</span>    <span class="n">permx</span><span class="o">.</span><span class="n">grdecl</span>    <span class="n">INIT_FILES</span><span class="p">:</span><span class="n">petro</span><span class="o">.</span><span class="n">grdecl</span>  <span class="n">FORWARD_INIT</span><span class="p">:</span><span class="kc">True</span>
</pre></div>
</div>
<p>Observe that forward model has created the file petro.grdecl and the nodes PORO
and PERMX create the ECLIPSE input files poro.grdecl and permx.grdecl, to ensure
that ECLIPSE finds the input files poro.grdecl and permx.grdecl the forward
model should contain a job which will copy/convert petro.grdecl -&gt;
(poro.grdecl,permx.grdecl), this job should not overwrite existing versions of
permx.grdecl and poro.grdecl. This extra hoops is not strictly needed in all
cases, but strongly recommended to ensure that you have control over which data
is used, and that everything is consistent in the case where the forward model
is run again.</p>
</div>
<div class="section" id="general-vector-parameters-gen-param">
<h3>General vector parameters: GEN_PARAM<a class="headerlink" href="#general-vector-parameters-gen-param" title="Permalink to this headline">¶</a></h3>
<p>The GEN_PARAM parameter type is used to estimate parameters which do not really
fit into any of the other categories. As an example, consider the following
situation:</p>
<p>Some external Software (e.g. Cohiba) makes a large vector of random numbers
which will serve as input to the forward model. (It is no requirement that the
parameter set is large, but if it only consists of a few parameters the GEN_KW
type will be easier to use.) We want to update this parameter with enkf. In
the main configuration file the input for a GEN_PARAM instance is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEN_PARAM</span>  <span class="n">ID</span>  <span class="n">ECLIPSE_FILE</span>  <span class="n">INPUT_FORMAT</span><span class="p">:</span><span class="n">xx</span>  <span class="n">OUTPUT_FORMAT</span><span class="p">:</span><span class="n">xx</span>  <span class="n">INIT_FILES</span><span class="p">:</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">init</span><span class="o">/</span><span class="n">files</span><span class="o">%</span><span class="n">d</span> <span class="p">(</span><span class="n">TEMPLATE</span><span class="p">:</span><span class="o">/</span><span class="n">template_file</span> <span class="n">KEY</span><span class="p">:</span><span class="n">magic_string</span><span class="p">)</span>
</pre></div>
</div>
<p>here ID is the usual unique string identifying this instance and ECLIPSE_FILE is
the name of the file which is written into the run directories. The three
arguments GEN_PARAM, ID and ECLIPSE_FILE must be the three first arguments. In
addition you must have three additional arguments, INPUT_FORMAT, OUTPUT_FORMAT
and INIT_FILES. INPUT_FORMAT is the format of the files enkf should load to
initialize, and OUTPUT_FORMAT is the format of the files enkf writes for the
forward model. The valid values are:</p>
<ul class="simple">
<li>ASCII - This is just text file with formatted numbers.</li>
<li>ASCII_TEMPLATE - An plain text file with formatted numbers, and an arbitrary header/footer.</li>
<li>BINARY_FLOAT - A vector of binary float numbers.</li>
<li>BINARY_DOUBLE - A vector of binary double numbers.</li>
</ul>
<p>Regarding the different formats - observe the following:</p>
<ol class="arabic simple">
<li>Except the format ASCII_TEMPLATE the files contain no header information.</li>
<li>The format ASCII_TEMPLATE can only be used as output format.</li>
<li>If you use the output format ASCII_TEMPLATE you must also supply a TEMPLATE:X and KEY:Y option. See documentation of this below.</li>
<li>For the binary formats files generated by Fortran can not be used - can easily be supported on request.</li>
</ol>
<p><strong>Regarding templates:</strong></p>
<p>If you use OUTPUT_FORMAT:ASCII_TEMPLATE you must also supply the arguments
TEMPLATE:/template/file and KEY:MaGiCKEY. The template file is an arbitrary
existing text file, and KEY is a magic string found in this file. When enkf is
running the magic string is replaced with parameter data when the ECLIPSE_FILE
is written to the directory where the simulation is run from. Consider for
example the follwing configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TEMPLATE</span><span class="p">:</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">file</span>   <span class="n">KEY</span><span class="p">:</span><span class="n">Magic123</span>
</pre></div>
</div>
<p>The template file can look like this (only the Magic123 is special):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">Header</span> <span class="n">line1</span>
      <span class="n">Header</span> <span class="n">line2</span>
<span class="o">============</span>
      <span class="n">Magic123</span>
      <span class="o">============</span>
      <span class="n">Footer</span> <span class="n">line1</span>
      <span class="n">Footer</span> <span class="n">line2</span>
</pre></div>
</div>
<p>When ERT is running the string Magic123 is replaced with parameter values, and
the resulting file will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Header</span> <span class="n">line1</span>
<span class="n">Header</span> <span class="n">line2</span>
<span class="o">============</span>
<span class="mf">1.6723</span>
<span class="mf">5.9731</span>
<span class="mf">4.8881</span>
<span class="o">.....</span>
<span class="o">============</span>
<span class="n">Footer</span> <span class="n">line1</span>
<span class="n">Footer</span> <span class="n">line2</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="simulated-data">
<h2>Simulated data<a class="headerlink" href="#simulated-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="summary-summary">
<h3>Summary: SUMMARY<a class="headerlink" href="#summary-summary" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="general-data-gen-data">
<h3>General data: GEN_DATA<a class="headerlink" href="#general-data-gen-data" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="keyword-results-custom-kw">
<h3>Keyword results: CUSTOM_KW<a class="headerlink" href="#keyword-results-custom-kw" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="enkf-heritage">
<h2>EnKF heritage<a class="headerlink" href="#enkf-heritage" title="Permalink to this headline">¶</a></h2>
<p>With regards to the datatypes in ERT this is a part of the application where the
EnKF heritage shows through quite clearly, the datetypes offered by ERT would
probably be different if ERT was made for Ensemble Smoother from the outset.
Pecularites of EnKF heritage include:</p>
<ol class="arabic simple">
<li>The <cite>FIELD</cite> implementation can behave both as a dynamic quantity, i.e.
pressure and saturation, and static property like porosity. In ERT it is
currently <em>only used</em> as a parameter, but that this <em>possible</em> dual usage
exists in the code adds a significant complexity.</li>
<li>The parameter types have an internal pseudo time dependence corresponding to
the “update time” induced by the EnKF scheme. This pseudo time dependence is
not directly exposed to the user, but it is still part of the implementation
and e.g. when writing plugins which work with parameter data managed by ERT
you must relate to it.</li>
<li>The time dependence of the <cite>GEN_DATA</cite> implementation. This is just too
complex, there have been numerous problems with people who configure the
<cite>GEN_DATA</cite> keywords incorrectly.</li>
</ol>
</div>
<div class="section" id="observations">
<h2>Observations<a class="headerlink" href="#observations" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../forward_model/index.html" title="Running simulations - the Forward Model"
             >next</a> |</li>
        <li class="right" >
          <a href="../introduction/index.html" title="Introduction to ERT and Ensemble based methods"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../manual.html">ERT 2.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Equinor.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>